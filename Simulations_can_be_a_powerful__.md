Simulations can be a powerful tool for developing and evaluating analysis methods but researchers need to be cautious in how they are used. Many current simulations of scRNA-seq data are poorly documented and irreproducible. Of particular concern is that papers that make use of simulations frequently fail to demonstrate similarity to real datasets and test analysis methods using simulations that have the same underlying assumptions as the method they are evaluating.

To address these concerns we have developed Splatter, an independent framework for the reproducible simulation of scRNA-seq data. Splatter is available as an R package from Bioconductor and currently implements several published simulation models. By following a series of clearly defined steps researchers can use Splatter to select simulations, estimate the required parameters from real data, modify any parameters relevant to their specific use, generate synthetic datasets and quickly create a series of diagnostic plots comparing them. 

As part of Splatter we introduce our own simulation Splat. Splat builds on the gamma-poisson (or negative binomial) distribution commonly used to represent RNA-seq data, adding high-expression outlier genes, defined library sizes, a mean-variance trend and the option to add expression based dropout. Extensions to Splat allow the simulation of more complex scenarios: multiple groups of cells with differing sizes and levels of differential expression or differentiation trajectories with multiple paths and branches, and genes that change in non-linear ways.

We performed an evaluation of the simulations available in Splatter by estimating parameters from five datasets, generating synthetic data using the different models and comparing them to the original data. Overall Splat performed well, ranking highly on most metrics, but we also observed that other simulations performed better for certain metrics or better reproduced specific datasets. We found the Camp cerebral organoid dataset the most challenging to reproduce, perhaps because of the complex nature of this sample and the number of different cell types. This dataset (along with the Engel data) used a full-length protocol which may contain additional noise compared to the UMI datasets. One of the key features of scRNA-seq data is the high number of zeros where no expression is observed. This can be particularly challenging to simulate as not only must there be the correct number of zeros but they must be correctly distributed across genes and cells and follow the known relationship between the expression level of a gene and the percentage of cells that show a zero count. These results demonstrate that no simulation can accurately reproduce all scRNA-seq datasets and emphasises the variability in scRNA-seq data which arises from a complex set of biological (for example species, tissue type, cell type, treatment and cell cycle) and technical (for example platform, protocol, or processing) factors. Non-parametric simulations that permute real data could be more realistic but at the cost of flexibility in what can be simulated and knowledge of the underlying parameters.

Finally, as demonstrated in our example evaluation of the SC3 clustering method, Splatter can be used in the development and evaluation of analysis methods. The simulations available in Splatter are well-documented, reproducible and independent of any new analysis methods. The comparison functions in Splatter allow users to easily demonstrate how similar simulations are to real datasets. Along with an expression matrix each simulation returns various intermediate parameters (base expression levels, DE factors etc.) which can be used as the truth in evaluations. Splatter makes existing scRNA-seq simulations accessible to reasearchers and provides a framework to add more as they become available. 