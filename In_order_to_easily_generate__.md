In order to easily generate a simulation that is similar to a given dataset Splatter includes functions to estimate the parameters for each simulation from real datasets. Just as with the simulations themselves the estimation procedures are based on what has been published and there is variation in how many parameters can be estimated for each model. We have given significant attention to estimating the parameters for the Splat simulation. The parameters that control the mean expression of each gene (\(\alpha\) and \(\beta\)) are estimated by fitting a gamma distribution to the winsorized means of the library size normalised counts using the fitdistrplus package \cite{Delignette_Muller_2015}. This is a basic normalisation where the counts in the original dataset are adjusted so that each has the same number of total counts (in this case the median across all cells) and any genes that are all zero are removed. We found that results of the fitting are affected by genes with extreme means and that this effect was mitigated by setting the top and bottom 10 percent of values to the 10th and 90th percentiles respectively. Parameters for the library size distribution (\(\mu^{L}\) and \(\sigma^{L}\)) are estimated in a similar way by fitting a log-normal distribution to the unnormalised library sizes.

The procedure for estimating expression outlier parameters is more complex. Taking the library size normalised counts, outliers are defined as genes where the mean expression is more than two Median Absolute Deviations (MADs) greater than the median mean gene expression level. The outlier probability \(\pi^{O}\) is then calculated as the proportion of genes that are outliers. Parameters for the outlier factors (\(\mu^{O}\) and \(\sigma^{O}\)) are estimated by fitting a log-normal distribution to the ratio of the means of the outlier genes to the median mean gene expression level.

BCV parameters are estimated using the estimateDispersion function in the edgeR package \cite{Robinson_2009}. When testing the estimation procedure on simulated datasets we observed that the edgeR estimate of common dispersion was inflated, therefore we apply a linear correction to this value (\(\hat{\phi} = 0.1 + 0.25\hat{\phi}_\textrm{edgeR}\)).

The midpoint (\(x_0\)) and shape (\(k\)) parameters for the dropout function are estimated by fitting a logistic function to the relationship between the log means of the normalised counts and the proportion of samples that are zero for each gene (Supplementary Figure X).